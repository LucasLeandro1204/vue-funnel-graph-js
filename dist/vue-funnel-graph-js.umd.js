!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polymorph-js"),require("@tweenjs/tween.js"),require("funnel-graph-js"),require("funnel-graph-js/src/js/number"),require("funnel-graph-js/src/js/graph"),require("funnel-graph-js/src/scss/main.scss"),require("funnel-graph-js/src/scss/theme.scss")):"function"==typeof define&&define.amd?define(["exports","polymorph-js","@tweenjs/tween.js","funnel-graph-js","funnel-graph-js/src/js/number","funnel-graph-js/src/js/graph","funnel-graph-js/src/scss/main.scss","funnel-graph-js/src/scss/theme.scss"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueFunnelGraph={},e.interpolate,e.TWEEN,e.FunnelGraph,e.formatNumber,e.getDefaultColors)}(this,(function(e,t,s,n,a,i){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=r(s),o=r(n);const h={name:"VueFunnelGraph",props:{animated:{type:Boolean,default:!1},width:[String,Number],height:[String,Number],values:Array,labels:Array,colors:{type:Array,default:()=>[]},subLabels:Array,subLabelValue:{type:String,default:"percent"},direction:{type:String,default:"horizontal"},gradientDirection:{type:String,default:"horizontal"},displayPercentage:{type:Boolean,default:!0}},data:()=>({paths:[],prevPaths:[],graph:null,tween:null,defaultColors:i.getDefaultColors(10)}),computed:{valuesFormatted(){return this.graph.is2d()?this.graph.getValues2d().map((e=>a.formatNumber(e))):this.values.map((e=>a.formatNumber(e)))},colorSet(){const e=[];let t=0;for(let s=0;s<this.paths.length;s++){const n=this.graph.is2d()?this.getColors[s]:this.getColors,a="string"==typeof n||1===n.length?"solid":"gradient";"gradient"===a&&(t+=1),e.push({values:n,fillMode:a,fill:"solid"===a?n:`url('#funnelGradient-${t}')`})}return e},gradientSet(){const e=[];return this.colorSet.forEach((t=>{"gradient"===t.fillMode&&e.push(t)})),e},getColors(){return this.colors instanceof Array&&0===this.colors.length?i.getDefaultColors(this.is2d()?this.values[0].length:2):this.colors.length<this.paths.length?[...this.colors].concat([...this.defaultColors].splice(this.paths.length,this.paths.length-this.colors.length)):this.colors},gradientAngle(){return`rotate(${"vertical"===this.gradientDirection?90:0})`}},methods:{enterTransition(e,t){this.animated||t(),setTimeout((()=>t()),700)},leaveTransition(e,t){this.animated||t(),setTimeout((()=>t()),700)},is2d(){return this.graph.is2d()},percentages(){return this.graph.createPercentages()},twoDimPercentages(){return this.is2d()?this.graph.getPercentages2d():[]},subLabelBackgrounds(e){return this.is2d()?i.generateLegendBackground(this.getColors[e],this.gradientDirection):[]},offsetColor:(e,t)=>`${Math.round(100*e/(t-1))}%`,makeAnimations(){null!==this.tween&&this.tween.stop();const e=[],s=this.prevPaths.length!==this.paths.length;let n={x:.5,y:.5};s&&(n={x:0,y:.5},this.graph.isVertical()&&(n={x:1,y:1}),this.graph.is2d()||(n={x:0,y:1})),this.paths.forEach(((a,i)=>{let r=this.prevPaths[i]||this.graph.getPathMedian(i);s&&(r=this.graph.getPathMedian(i));const l=t.interpolate([r,a],{addPoints:1,origin:n,optimize:"fill",precision:1});e.push(l)}));const a={value:0};this.tween=new l.default.Tween(a).to({value:1},700).easing(l.default.Easing.Cubic.InOut).onUpdate((()=>{for(let t=0;t<this.paths.length;t++)this.$set(this.paths,t,e[t](a.value))})),this.tween.start(),function e(){l.default.update()&&requestAnimationFrame(e)}()},drawPaths(){this.prevPaths=this.paths,this.paths=[];this.graph.getPathDefinitions().forEach((e=>{this.paths.push(e)}))}},created(){this.graph=new o.default({height:this.height,width:this.width,direction:this.direction,data:{labels:this.labels,values:this.values}}),this.drawPaths(),this.animated&&this.makeAnimations()},watch:{values(){this.graph.setValues(this.values),this.drawPaths(),this.animated&&this.makeAnimations()},direction(){this.graph.setDirection(this.direction).setWidth(this.width).setHeight(this.height),this.drawPaths()}},filters:{format:function(e){return a.formatNumber(e)}}},u={};var c=function(e,t,s,n,a,i,r,l){var o,h="function"==typeof e?e.options:e;if(t&&(h.render=t,h.staticRenderFns=s,h._compiled=!0),n&&(h.functional=!0),i&&(h._scopeId="data-v-"+i),r?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},h._ssrRegister=o):a&&(o=l?function(){a.call(this,(h.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(h.functional){h._injectStyles=o;var u=h.render;h.render=function(e,t){return o.call(t),u(e,t)}}else{var c=h.beforeCreate;h.beforeCreate=c?[].concat(c,o):[o]}return{exports:e,options:h}}(h,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"funnel svg-funnel-js",class:{"svg-funnel-js--vertical":"vertical"===e.direction}},[s("div",{staticClass:"svg-funnel-js__container"},[s("svg",{attrs:{width:e.width,height:e.height}},[s("defs",e._l(e.gradientSet,(function(t,n){return s("linearGradient",{key:n,attrs:{id:"funnelGradient-"+(n+1),gradientTransform:e.gradientAngle}},e._l(t.values,(function(n,a){return s("stop",{key:a,attrs:{"stop-color":n,offset:e.offsetColor(a,t.values.length)}})})),1)})),1),e._l(e.paths,(function(t,n){return s("path",{key:n,attrs:{fill:e.colorSet[n].fill,stroke:e.colorSet[n].fill,d:t}})}))],2)]),s("transition-group",{staticClass:"svg-funnel-js__labels",attrs:{name:"appear",tag:"div"},on:{enter:e.enterTransition,leave:e.leaveTransition}},e._l(e.valuesFormatted,(function(t,n){return s("div",{key:e.labels[n].toLowerCase().split(" ").join("-"),staticClass:"svg-funnel-js__label",class:"label-"+(n+1)},[s("div",{staticClass:"label__value"},[e._v(e._s(t))]),e.labels?s("div",{staticClass:"label__title"},[e._v(e._s(e.labels[n]))]):e._e(),e.displayPercentage&&100!==e.percentages()[n]?s("div",{staticClass:"label__percentage"},[e._v(" "+e._s(e.percentages()[n])+"% ")]):e._e(),e.is2d()?s("div",{staticClass:"label__segment-percentages"},[s("ul",{staticClass:"segment-percentage__list"},e._l(e.subLabels,(function(t,a){return s("li",{key:a},[e._v(" "+e._s(t)+": "),"percent"===e.subLabelValue?s("span",{staticClass:"percentage__list-label"},[e._v(e._s(e.twoDimPercentages()[n][a])+"%")]):s("span",{staticClass:"percentage__list-label"},[e._v(e._s(e._f("format")(e.values[n][a])))])])})),0)]):e._e()])})),0),s("transition",{attrs:{name:"fade"},on:{enter:e.enterTransition,leave:e.leaveTransition}},[e.is2d()?s("div",{staticClass:"svg-funnel-js__subLabels"},e._l(e.subLabels,(function(t,n){return s("div",{key:n,class:"svg-funnel-js__subLabel svg-funnel-js__subLabel-"+(n+1)},[s("div",{staticClass:"svg-funnel-js__subLabel--color",style:e.subLabelBackgrounds(n)}),s("div",{staticClass:"svg-funnel-js__subLabel--title"},[e._v(e._s(t))])])})),0):e._e()])],1)}),[],!1,(function(e){for(let t in u)this[t]=u[t]}),"2741205a",null,null).exports,d=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",VueFunnelGraph:c});const g={install:function e(t){e.installed||(e.installed=!0,Object.keys(d).forEach((e=>{t.component(e,d[e])})))}};let p=null;"undefined"!=typeof window?p=window.Vue:"undefined"!=typeof global&&(p=global.Vue),p&&p.use(g),e.VueFunnelGraph=c,e.default=g,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
